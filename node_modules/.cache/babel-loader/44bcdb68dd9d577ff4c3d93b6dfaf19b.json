{"ast":null,"code":"import _slicedToArray from \"/home/allie/Project/client-thecurrent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/allie/Project/client-thecurrent/src/components/EditPost/EditPost.jsx\";\nimport \"./EditPost.css\";\nimport { Button, Card, Container, Form, Spinner } from \"react-bootstrap\";\nimport React, { useEffect, useState } from \"react\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport { CKEditor } from \"@ckeditor/ckeditor5-react\";\nimport ClassicEditor from \"@aaditya1978/ckeditor5-build-classic\";\nimport Footer from \"../Footer/Footer\";\nimport NavBar from \"../NavBar/NavBar\";\nimport SelectForm from \"../SelectForm/SelectForm\";\nimport axios from \"axios\";\nexport default function EditPost() {\n  var navigate = useNavigate();\n\n  var _useParams = useParams(),\n      id = _useParams.id;\n\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      title = _useState2[0],\n      setTitle = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      category = _useState4[0],\n      setCategory = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      content = _useState6[0],\n      setContent = _useState6[1];\n\n  var _useState7 = useState(null),\n      _useState8 = _slicedToArray(_useState7, 2),\n      image = _useState8[0],\n      setImage = _useState8[1];\n\n  var _useState9 = useState(null),\n      _useState10 = _slicedToArray(_useState9, 2),\n      imageData = _useState10[0],\n      setImageData = _useState10[1];\n\n  var _useState11 = useState(\"\"),\n      _useState12 = _slicedToArray(_useState11, 2),\n      imageName = _useState12[0],\n      setImageName = _useState12[1];\n\n  var _useState13 = useState(false),\n      _useState14 = _slicedToArray(_useState13, 2),\n      submitting = _useState14[0],\n      setSubmitting = _useState14[1];\n\n  var _useState15 = useState(false),\n      _useState16 = _slicedToArray(_useState15, 2),\n      error = _useState16[0],\n      setError = _useState16[1];\n\n  var _useState17 = useState(\"\"),\n      _useState18 = _slicedToArray(_useState17, 2),\n      errorMessage = _useState18[0],\n      setErrorMessage = _useState18[1];\n\n  var _useState19 = useState(false),\n      _useState20 = _slicedToArray(_useState19, 2),\n      notify = _useState20[0],\n      setNotify = _useState20[1];\n\n  useEffect(function () {\n    if (!localStorage.getItem(\"token\")) {\n      navigate(\"/login\");\n    }\n\n    axios.get(\"\".concat(process.env.REACT_APP_BASE_URL, \"/api/user/post/\").concat(id)).then(function (res) {\n      setTitle(res.data.blog.title);\n      setCategory(res.data.blog.category);\n      setContent(res.data.blog.content);\n      setImageData(res.data.blog.image);\n      setImage(res.data.blog.image);\n    }).catch(function (err) {\n      navigate(\"/login\");\n    });\n  }, [navigate, id]);\n\n  var handleSubmit = function handleSubmit(e) {\n    e.preventDefault();\n    setSubmitting(true);\n    var sanitizeContent = content.trim();\n\n    if (sanitizeContent.length < 200) {\n      setError(true);\n      setErrorMessage(\"Content must be at least 200 characters long\");\n      setSubmitting(false);\n      setTimeout(function () {\n        setError(false);\n        setErrorMessage(\"\");\n      }, 5000);\n      return;\n    }\n\n    var formData = new FormData();\n    formData.append(\"id\", id);\n    formData.append(\"title\", title);\n    formData.append(\"category\", category);\n    formData.append(\"content\", sanitizeContent);\n    formData.append(\"image\", imageData);\n    formData.append(\"date\", new Date());\n    formData.append(\"token\", localStorage.getItem(\"token\"));\n    axios.post(\"\".concat(process.env.REACT_APP_BASE_URL, \"/api/user/edit\"), formData).then(function (res) {\n      setSubmitting(false);\n      setNotify(!notify);\n      setInterval(function () {\n        setNotify(!notify);\n        navigate(\"/profile\");\n      }, 3000);\n    }).catch(function (err) {\n      setSubmitting(false);\n      setError(true);\n      setErrorMessage(err.response.data.error);\n\n      if (err.response.status === 401) {\n        navigate(\"/login\");\n      }\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(NavBar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"editpost-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Card.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    className: \"heading\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 15\n    }\n  }, \"Edit Post\"), /*#__PURE__*/React.createElement(Form, {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Form.Group, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(SelectForm, {\n    category: category,\n    setCategory: setCategory,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 19\n    }\n  }, \"Add Cover Image\"), /*#__PURE__*/React.createElement(Form.Control, {\n    type: \"File\",\n    accept: \"image/*\",\n    value: imageName,\n    onChange: function onChange(e) {\n      setImage(URL.createObjectURL(e.target.files[0]));\n      setImageData(e.target.files[0]);\n      setImageName(e.target.value);\n    },\n    name: \"image\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 19\n    }\n  }), image && /*#__PURE__*/React.createElement(\"img\", {\n    className: \"img-preview\",\n    src: image,\n    alt: \"preview\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 19\n    }\n  }), image && /*#__PURE__*/React.createElement(Button, {\n    variant: \"primary\",\n    className: \"remove-image\",\n    onClick: function onClick() {\n      setImage(null);\n      setImageData(null);\n      setImageName(\"\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 21\n    }\n  }, \"Remove\")), /*#__PURE__*/React.createElement(Form.Group, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Form.Control, {\n    type: \"text\",\n    className: \"postTitle\",\n    placeholder: \"Post Title Here\",\n    value: title,\n    onChange: function onChange(e) {\n      setTitle(e.target.value);\n    },\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 19\n    }\n  })), /*#__PURE__*/React.createElement(CKEditor, {\n    editor: ClassicEditor,\n    onChange: function onChange(event, editor) {\n      var data = editor.getData();\n      setContent(data);\n    },\n    data: content,\n    config: {\n      placeholder: \"Start typing your blog here...\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(Button, Object.assign({\n    type: \"submit\",\n    variant: \"success\",\n    className: \"mt-3 submit\"\n  }, submitting ? {\n    disabled: true\n  } : {}, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 17\n    }\n  }), submitting ? /*#__PURE__*/React.createElement(Spinner, {\n    as: \"span\",\n    animation: \"border\",\n    role: \"status\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 21\n    }\n  }) : \"Publish\")), error && /*#__PURE__*/React.createElement(\"p\", {\n    className: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 25\n    }\n  }, errorMessage))))), /*#__PURE__*/React.createElement(Notify, {\n    notify: notify,\n    title: \"Updated Successfully!\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 7\n    }\n  }));\n}","map":{"version":3,"sources":["/home/allie/Project/client-thecurrent/src/components/EditPost/EditPost.jsx"],"names":["Button","Card","Container","Form","Spinner","React","useEffect","useState","useNavigate","useParams","CKEditor","ClassicEditor","Footer","NavBar","SelectForm","axios","EditPost","navigate","id","title","setTitle","category","setCategory","content","setContent","image","setImage","imageData","setImageData","imageName","setImageName","submitting","setSubmitting","error","setError","errorMessage","setErrorMessage","notify","setNotify","localStorage","getItem","get","process","env","REACT_APP_BASE_URL","then","res","data","blog","catch","err","handleSubmit","e","preventDefault","sanitizeContent","trim","length","setTimeout","formData","FormData","append","Date","post","setInterval","response","status","URL","createObjectURL","target","files","value","event","editor","getData","placeholder","disabled"],"mappings":"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","sourcesContent":["import \"./EditPost.css\";\n\nimport { Button, Card, Container, Form, Spinner } from \"react-bootstrap\";\nimport React, { useEffect, useState } from \"react\";\nimport { useNavigate, useParams } from \"react-router-dom\";\n\nimport { CKEditor } from \"@ckeditor/ckeditor5-react\";\nimport ClassicEditor from \"@aaditya1978/ckeditor5-build-classic\";\nimport Footer from \"../Footer/Footer\";\nimport NavBar from \"../NavBar/NavBar\";\nimport SelectForm from \"../SelectForm/SelectForm\";\nimport axios from \"axios\";\n\nexport default function EditPost() {\n  const navigate = useNavigate();\n\n  const { id } = useParams();\n\n  const [title, setTitle] = useState(\"\");\n  const [category, setCategory] = useState(\"\");\n  const [content, setContent] = useState(\"\");\n  const [image, setImage] = useState(null);\n  const [imageData, setImageData] = useState(null);\n  const [imageName, setImageName] = useState(\"\");\n  const [submitting, setSubmitting] = useState(false);\n  const [error, setError] = useState(false);\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const [notify, setNotify] = useState(false);\n\n  useEffect(() => {\n    if (!localStorage.getItem(\"token\")) {\n      navigate(\"/login\");\n    }\n    axios\n      .get(`${process.env.REACT_APP_BASE_URL}/api/user/post/${id}`)\n      .then((res) => {\n        setTitle(res.data.blog.title);\n        setCategory(res.data.blog.category);\n        setContent(res.data.blog.content);\n        setImageData(res.data.blog.image);\n        setImage(res.data.blog.image);\n      })\n      .catch((err) => {\n        navigate(\"/login\");\n      });\n  }, [navigate, id]);\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    setSubmitting(true);\n    const sanitizeContent = content.trim();\n    if (sanitizeContent.length < 200) {\n      setError(true);\n      setErrorMessage(\"Content must be at least 200 characters long\");\n      setSubmitting(false);\n      setTimeout(() => {\n        setError(false);\n        setErrorMessage(\"\");\n      }, 5000);\n      return;\n    }\n    const formData = new FormData();\n    formData.append(\"id\", id);\n    formData.append(\"title\", title);\n    formData.append(\"category\", category);\n    formData.append(\"content\", sanitizeContent);\n    formData.append(\"image\", imageData);\n    formData.append(\"date\", new Date());\n    formData.append(\"token\", localStorage.getItem(\"token\"));\n\n    axios\n      .post(`${process.env.REACT_APP_BASE_URL}/api/user/edit`, formData)\n      .then((res) => {\n        setSubmitting(false);\n        setNotify(!notify);\n\n        setInterval(() => {\n          setNotify(!notify);\n          navigate(\"/profile\");\n        }, 3000);\n      })\n      .catch((err) => {\n        setSubmitting(false);\n        setError(true);\n        setErrorMessage(err.response.data.error);\n        if (err.response.status === 401) {\n          navigate(\"/login\");\n        }\n      });\n  };\n\n  return (\n    <>\n      <NavBar />\n      <div className=\"editpost-container\">\n        <Container>\n          <Card>\n            <Card.Body>\n              <h1 className=\"heading\">Edit Post</h1>\n              <Form onSubmit={handleSubmit}>\n                <Form.Group className=\"mb-3\">\n                  <SelectForm category={category} setCategory={setCategory} />\n                  <Form.Label>Add Cover Image</Form.Label>\n                  <Form.Control\n                    type=\"File\"\n                    accept=\"image/*\"\n                    value={imageName}\n                    onChange={(e) => {\n                      setImage(URL.createObjectURL(e.target.files[0]));\n                      setImageData(e.target.files[0]);\n                      setImageName(e.target.value);\n                    }}\n                    name=\"image\"\n                  />\n                  {image && (\n                    <img className=\"img-preview\" src={image} alt=\"preview\" />\n                  )}\n                  <br />\n                  {image && (\n                    <Button\n                      variant=\"primary\"\n                      className=\"remove-image\"\n                      onClick={() => {\n                        setImage(null);\n                        setImageData(null);\n                        setImageName(\"\");\n                      }}\n                    >\n                      Remove\n                    </Button>\n                  )}\n                </Form.Group>\n                <Form.Group className=\"mb-3\">\n                  <Form.Control\n                    type=\"text\"\n                    className=\"postTitle\"\n                    placeholder=\"Post Title Here\"\n                    value={title}\n                    onChange={(e) => {\n                      setTitle(e.target.value);\n                    }}\n                    required\n                  />\n                </Form.Group>\n                <CKEditor\n                  editor={ClassicEditor}\n                  onChange={(event, editor) => {\n                    const data = editor.getData();\n                    setContent(data);\n                  }}\n                  data={content}\n                  config={{\n                    placeholder: \"Start typing your blog here...\",\n                  }}\n                />\n                <Button\n                  type=\"submit\"\n                  variant=\"success\"\n                  className=\"mt-3 submit\"\n                  {...(submitting ? { disabled: true } : {})}\n                >\n                  {submitting ? (\n                    <Spinner as=\"span\" animation=\"border\" role=\"status\" />\n                  ) : (\n                    \"Publish\"\n                  )}\n                </Button>\n              </Form>\n              {error && <p className=\"error\">{errorMessage}</p>}\n            </Card.Body>\n          </Card>\n        </Container>\n      </div>\n      <Notify notify={notify} title=\"Updated Successfully!\" />\n      <Footer />\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}