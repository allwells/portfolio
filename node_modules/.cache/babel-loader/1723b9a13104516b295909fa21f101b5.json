{"ast":null,"code":"import _slicedToArray from \"/home/allie/Project/client-thecurrent/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/allie/Project/client-thecurrent/src/components/CreatePost/CreatePost.jsx\";\nimport \"./CreatePost.css\";\nimport { Button, Card, Container, Form, Spinner } from \"react-bootstrap\";\nimport React, { useEffect, useState } from \"react\";\nimport { CKEditor } from \"@ckeditor/ckeditor5-react\";\nimport ClassicEditor from \"@aaditya1978/ckeditor5-build-classic\";\nimport Footer from \"../Footer/Footer\";\nimport NavBar from \"../NavBar/NavBar\";\nimport Notify from \"../Notification/Notify\";\nimport SelectForm from \"../SelectForm/SelectForm\";\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\nexport default function CreatePost() {\n  var navigate = useNavigate();\n\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      title = _useState2[0],\n      setTitle = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      category = _useState4[0],\n      setCategory = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      content = _useState6[0],\n      setContent = _useState6[1];\n\n  var _useState7 = useState(null),\n      _useState8 = _slicedToArray(_useState7, 2),\n      image = _useState8[0],\n      setImage = _useState8[1];\n\n  var _useState9 = useState(null),\n      _useState10 = _slicedToArray(_useState9, 2),\n      imageData = _useState10[0],\n      setImageData = _useState10[1];\n\n  var _useState11 = useState(\"\"),\n      _useState12 = _slicedToArray(_useState11, 2),\n      imageName = _useState12[0],\n      setImageName = _useState12[1];\n\n  var _useState13 = useState(false),\n      _useState14 = _slicedToArray(_useState13, 2),\n      submitting = _useState14[0],\n      setSubmitting = _useState14[1];\n\n  var _useState15 = useState(false),\n      _useState16 = _slicedToArray(_useState15, 2),\n      error = _useState16[0],\n      setError = _useState16[1];\n\n  var _useState17 = useState(\"\"),\n      _useState18 = _slicedToArray(_useState17, 2),\n      errorMessage = _useState18[0],\n      setErrorMessage = _useState18[1];\n\n  var _useState19 = useState(false),\n      _useState20 = _slicedToArray(_useState19, 2),\n      notify = _useState20[0],\n      setNotify = _useState20[1];\n\n  useEffect(function () {\n    if (!localStorage.getItem(\"token\")) {\n      navigate(\"/login\");\n    }\n  }, [navigate]);\n\n  var handleSubmit = function handleSubmit(e) {\n    e.preventDefault();\n    setSubmitting(true);\n    var sanitizeContent = content.trim();\n\n    if (sanitizeContent.length < 200) {\n      setError(true);\n      setErrorMessage(\"Content must be at least 200 characters long\");\n      setSubmitting(false);\n      setTimeout(function () {\n        setError(false);\n        setErrorMessage(\"\");\n      }, 5000);\n      return;\n    }\n\n    var formData = new FormData();\n    formData.append(\"title\", title);\n    formData.append(\"content\", sanitizeContent);\n    formData.append(\"category\", category);\n    formData.append(\"image\", imageData);\n    formData.append(\"date\", new Date());\n    formData.append(\"token\", localStorage.getItem(\"token\"));\n    axios({\n      method: \"post\",\n      url: \"\".concat(process.env.REACT_APP_BASE_URL, \"/api/user/create\"),\n      data: formData\n    }).then(function (res) {\n      setSubmitting(false);\n      setNotify(true);\n      setInterval(function () {\n        setNotify(false);\n        navigate(\"/\");\n      }, 3000);\n    }).catch(function (err) {\n      setSubmitting(false);\n      setError(true);\n      setErrorMessage(err.response.data.error);\n      navigate(\"/login\");\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(NavBar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"createpost-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Container, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Card.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    className: \"heading\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 15\n    }\n  }, \"Create Post\"), /*#__PURE__*/React.createElement(Form, {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Form.Group, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(SelectForm, {\n    category: category,\n    setCategory: setCategory,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 19\n    }\n  }, \"Add Cover Image\"), /*#__PURE__*/React.createElement(Form.Control, {\n    type: \"File\",\n    accept: \"image/*\",\n    value: imageName,\n    onChange: function onChange(e) {\n      setImage(URL.createObjectURL(e.target.files[0]));\n      setImageData(e.target.files[0]);\n      setImageName(e.target.value);\n    },\n    name: \"image\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 19\n    }\n  }), image && /*#__PURE__*/React.createElement(\"img\", {\n    className: \"img-preview\",\n    src: image,\n    alt: \"preview\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 19\n    }\n  }), image && /*#__PURE__*/React.createElement(Button, {\n    variant: \"primary\",\n    className: \"remove-image\",\n    onClick: function onClick() {\n      setImage(null);\n      setImageData(null);\n      setImageName(\"\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 21\n    }\n  }, \"Remove\")), /*#__PURE__*/React.createElement(Form.Group, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Form.Control, {\n    type: \"text\",\n    className: \"postTitle\",\n    placeholder: \"Post Title Here\",\n    value: title,\n    onChange: function onChange(e) {\n      setTitle(e.target.value);\n    },\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 19\n    }\n  })), /*#__PURE__*/React.createElement(CKEditor, {\n    editor: ClassicEditor,\n    onChange: function onChange(event, editor) {\n      var data = editor.getData();\n      setContent(data);\n    },\n    config: {\n      placeholder: \"Start typing your blog here...\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(Button, Object.assign({\n    type: \"submit\",\n    variant: \"success\",\n    className: \"mt-3 submit\"\n  }, submitting ? {\n    disabled: true\n  } : {}, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 17\n    }\n  }), submitting ? /*#__PURE__*/React.createElement(Spinner, {\n    as: \"span\",\n    animation: \"border\",\n    role: \"status\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 21\n    }\n  }) : \"Publish\")), error && /*#__PURE__*/React.createElement(\"p\", {\n    className: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 25\n    }\n  }, errorMessage))))), /*#__PURE__*/React.createElement(Notify, {\n    notify: notify,\n    title: \"Published Successfully!\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 7\n    }\n  }));\n}","map":{"version":3,"sources":["/home/allie/Project/client-thecurrent/src/components/CreatePost/CreatePost.jsx"],"names":["Button","Card","Container","Form","Spinner","React","useEffect","useState","CKEditor","ClassicEditor","Footer","NavBar","Notify","SelectForm","axios","useNavigate","CreatePost","navigate","title","setTitle","category","setCategory","content","setContent","image","setImage","imageData","setImageData","imageName","setImageName","submitting","setSubmitting","error","setError","errorMessage","setErrorMessage","notify","setNotify","localStorage","getItem","handleSubmit","e","preventDefault","sanitizeContent","trim","length","setTimeout","formData","FormData","append","Date","method","url","process","env","REACT_APP_BASE_URL","data","then","res","setInterval","catch","err","response","URL","createObjectURL","target","files","value","event","editor","getData","placeholder","disabled"],"mappings":"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","sourcesContent":["import \"./CreatePost.css\";\n\nimport { Button, Card, Container, Form, Spinner } from \"react-bootstrap\";\nimport React, { useEffect, useState } from \"react\";\n\nimport { CKEditor } from \"@ckeditor/ckeditor5-react\";\nimport ClassicEditor from \"@aaditya1978/ckeditor5-build-classic\";\nimport Footer from \"../Footer/Footer\";\nimport NavBar from \"../NavBar/NavBar\";\nimport Notify from \"../Notification/Notify\";\nimport SelectForm from \"../SelectForm/SelectForm\";\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\n\nexport default function CreatePost() {\n  const navigate = useNavigate();\n\n  const [title, setTitle] = useState(\"\");\n  const [category, setCategory] = useState(\"\");\n  const [content, setContent] = useState(\"\");\n  const [image, setImage] = useState(null);\n  const [imageData, setImageData] = useState(null);\n  const [imageName, setImageName] = useState(\"\");\n  const [submitting, setSubmitting] = useState(false);\n  const [error, setError] = useState(false);\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const [notify, setNotify] = useState(false);\n\n  useEffect(() => {\n    if (!localStorage.getItem(\"token\")) {\n      navigate(\"/login\");\n    }\n  }, [navigate]);\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    setSubmitting(true);\n    const sanitizeContent = content.trim();\n\n    if (sanitizeContent.length < 200) {\n      setError(true);\n      setErrorMessage(\"Content must be at least 200 characters long\");\n      setSubmitting(false);\n      setTimeout(() => {\n        setError(false);\n        setErrorMessage(\"\");\n      }, 5000);\n      return;\n    }\n\n    const formData = new FormData();\n    formData.append(\"title\", title);\n    formData.append(\"content\", sanitizeContent);\n    formData.append(\"category\", category);\n    formData.append(\"image\", imageData);\n    formData.append(\"date\", new Date());\n    formData.append(\"token\", localStorage.getItem(\"token\"));\n\n    axios({\n      method: \"post\",\n      url: `${process.env.REACT_APP_BASE_URL}/api/user/create`,\n      data: formData,\n    })\n      .then((res) => {\n        setSubmitting(false);\n        setNotify(true);\n\n        setInterval(() => {\n          setNotify(false);\n          navigate(\"/\");\n        }, 3000);\n      })\n      .catch((err) => {\n        setSubmitting(false);\n        setError(true);\n        setErrorMessage(err.response.data.error);\n        navigate(\"/login\");\n      });\n  };\n\n  return (\n    <>\n      <NavBar />\n      <div className=\"createpost-container\">\n        <Container>\n          <Card>\n            <Card.Body>\n              <h1 className=\"heading\">Create Post</h1>\n              <Form onSubmit={handleSubmit}>\n                <Form.Group className=\"mb-3\">\n                  <SelectForm category={category} setCategory={setCategory} />\n                  <Form.Label>Add Cover Image</Form.Label>\n                  <Form.Control\n                    type=\"File\"\n                    accept=\"image/*\"\n                    value={imageName}\n                    onChange={(e) => {\n                      setImage(URL.createObjectURL(e.target.files[0]));\n                      setImageData(e.target.files[0]);\n                      setImageName(e.target.value);\n                    }}\n                    name=\"image\"\n                  />\n                  {image && (\n                    <img className=\"img-preview\" src={image} alt=\"preview\" />\n                  )}\n                  <br />\n                  {image && (\n                    <Button\n                      variant=\"primary\"\n                      className=\"remove-image\"\n                      onClick={() => {\n                        setImage(null);\n                        setImageData(null);\n                        setImageName(\"\");\n                      }}\n                    >\n                      Remove\n                    </Button>\n                  )}\n                </Form.Group>\n                <Form.Group className=\"mb-3\">\n                  <Form.Control\n                    type=\"text\"\n                    className=\"postTitle\"\n                    placeholder=\"Post Title Here\"\n                    value={title}\n                    onChange={(e) => {\n                      setTitle(e.target.value);\n                    }}\n                    required\n                  />\n                </Form.Group>\n                <CKEditor\n                  editor={ClassicEditor}\n                  onChange={(event, editor) => {\n                    const data = editor.getData();\n                    setContent(data);\n                  }}\n                  config={{\n                    placeholder: \"Start typing your blog here...\",\n                  }}\n                />\n                <Button\n                  type=\"submit\"\n                  variant=\"success\"\n                  className=\"mt-3 submit\"\n                  {...(submitting ? { disabled: true } : {})}\n                >\n                  {submitting ? (\n                    <Spinner as=\"span\" animation=\"border\" role=\"status\" />\n                  ) : (\n                    \"Publish\"\n                  )}\n                </Button>\n              </Form>\n              {error && <p className=\"error\">{errorMessage}</p>}\n            </Card.Body>\n          </Card>\n        </Container>\n      </div>\n      <Notify notify={notify} title=\"Published Successfully!\" />\n      <Footer />\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}